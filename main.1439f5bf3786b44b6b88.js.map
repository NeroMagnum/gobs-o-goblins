{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./node_modules/overprint/overprint/char.js","webpack:///./node_modules/overprint/overprint/font.js","webpack:///./node_modules/overprint/overprint/color.js","webpack:///./node_modules/overprint/overprint/cell.js","webpack:///./node_modules/overprint/overprint/display-state.js","webpack:///./node_modules/overprint/overprint/text-grid.js","webpack:///./src/index.js"],"names":["installedModules","__webpack_require__","moduleId","exports","module","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","prototype","hasOwnProperty","p","s","Char","Font","family","weight","size","toCSS","this","Color","BLACK","WHITE","Cell","character","foregroundColor","backgroundColor","NULL","blank","fillArray2D","width","height","fill","list","Array","col","row","DisplayState","_width","_height","_renderedCells","_updatedCells","_dirty","x","y","cell","undefined","callback","defaultSettings","font","emptyCell","isResponsive","forceSquare","TextGrid","canvas","settings","_settings","assign","_font","_responsive","_squared","_emptyCell","_glyphCache","Map","_canvas","_context","getContext","willReadFrequently","_ratio","window","devicePixelRatio","_display","resetLayout","clear","style","elementWidth","parseInt","elementHeight","_cellWidth","Math","floor","_cellHeight","max","textMeasure","measureText","textWidth","ceil","textHeight","drawWidth","drawHeight","textAlign","textBaseline","_cellCache","setCell","getCell","setCharacter","render","cellWidth","cellHeight","blitKey","has","putImageData","fillStyle","fillRect","xPos","yPos","fillText","round","blitCell","getImageData","set","ev","bounds","getBoundingClientRect","relativeX","clientX","left","relativeY","clientY","top","trunc","handler","addEventListener","pxToCell","console","log","grid","document","querySelector","writeCell","action","player","input","requestAnimationFrame","gameLoop","min"],"mappings":"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","file":"main.1439f5bf3786b44b6b88.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 0);\n","const Char = {}\n\nChar.WHITE_SMILING_FACE = '☺';\nChar.BLACK_SMILING_FACE = '☻';\nChar.BLACK_HEART_SUIT = '♥';\nChar.BLACK_DIAMOND_SUIT = '♦';\nChar.BLACK_CLUB_SUIT = '♣';\nChar.BLACK_SPADE_SUIT = '♠';\nChar.BULLET = '•';\nChar.INVERSE_BULLET = '◘';\nChar.WHITE_CIRCLE = '○';\nChar.INVERSE_WHITE_CIRCLE = '◙';\nChar.MALE_SIGN = '♂';\nChar.FEMALE_SIGN = '♀';\nChar.EIGHTH_NOTE = '♪';\nChar.BEAMED_EIGHTH_NOTES = '♫';\nChar.WHITE_SUN_WITH_RAYS = '☼';\n\nChar.NULL = ' ';\nChar.SPACE = ' ';\nChar.AMPERSAND = '&';\nChar.DOT = '.';\nChar.FULL_STOP = '.';\nChar.PLUS = '+';\nChar.MINUS = '-';\nChar.HASH = '#';\nChar.DOLLAR = '$';\nChar.PERCENT = '%';\nChar.CARET = '^';\nChar.ASTERISK = '*';\nChar.TILDE = '~';\nChar.LEFT_PARENS = '(';\nChar.RIGHT_PARENS = ')';\nChar.LEFT_BRACKET = '[';\nChar.RIGHT_BRACKET = ']';\nChar.AT = '@';\n\nexport default Char;\n","const Font = function(family, weight, size) {\n\treturn {\n\t\tfamily: family || 'monospace',\n\t\tweight: weight || 'normal',\n\t\tsize: size || 16,\n\t\ttoCSS: function() {\n\t\t\treturn this.weight + ' '+ this.size +'px ' + this.family;\n\t\t}\n\t}\n}\n\nexport default Font;\n","const Color = {\n  BLACK: '#000',\n  WHITE: '#fff'\n}\n\nexport default Color;\n","import Char from './char'\nimport Color from './color'\n\nconst Cell = function(character, foregroundColor, backgroundColor) {\n\treturn {\n\t\tcharacter: character || Char.NULL,\n\t\tforegroundColor: foregroundColor || Color.WHITE,\n\t\tbackgroundColor: backgroundColor || Color.BLACK\n\t}\n}\n\nCell.blank = function(backgroundColor) {\n  return Cell(false, false, backgroundColor);\n}\n\nexport default Cell;\n","function fillArray2D(width, height, fill) {\n  const list = new Array(width);\n  for (let col=0; col<width; col++) {\n    list[col] = new Array(height);\n    for (let row=0; row<height; row++) {\n      list[col][row] = fill;\n    }\n  }\n  return list;\n}\n\nclass DisplayState {\n  constructor(width, height) {\n    this._width = width;\n  \tthis._height = height;\n\n    this._renderedCells = fillArray2D(width, height, null);\n  \tthis._updatedCells = fillArray2D(width, height, null);\n\n  \tthis._dirty = true;\n  }\n\n  setCharacter(x, y, character) {\n    if (x < 0) return;\n    if (x >= this._width) return;\n    if (y < 0) return;\n    if (y >= this._height) return;\n\n    if (!character) return;\n\n    if (this._renderedCells[x][y].character != character) {\n      const foregroundColor = this._updatedCells[x][y].foregroundColor || this._renderedCells[x][y].foregroundColor\n      const backgroundColor = this._updatedCells[x][y].backgroundColor || this._renderedCells[x][y].backgroundColor\n      this._updatedCells[x][y] = {\n        character,\n        foregroundColor,\n        backgroundColor\n      };\n      this._dirty = true;\n    } else {\n      this._updatedCells[x][y] = null;\n    }\n  }\n\n  setCell(x, y, cell) {\n  \tif (x < 0) return;\n  \tif (x >= this._width) return;\n  \tif (y < 0) return;\n  \tif (y >= this._height) return;\n    if (cell == undefined) return;\n\n    if (this._renderedCells[x][y] == null ||\n      (this._renderedCells[x][y].character != cell.character ||\n      this._renderedCells[x][y].foregroundColor != cell.foregroundColor ||\n      this._renderedCells[x][y].backgroundColor != cell.backgroundColor)) {\n  \t\tthis._updatedCells[x][y] = cell;\n  \t\tthis._dirty = true;\n  \t} else {\n  \t\tthis._updatedCells[x][y] = null;\n  \t}\n  }\n\n  getCell(x, y) {\n    if (x < 0) return;\n  \tif (x >= this._width) return;\n  \tif (y < 0) return;\n  \tif (y >= this._height) return;\n\n    return this._updatedCells[x][y] || this._renderedCells[x][y];\n  }\n\n  render(callback) {\n  \tif (!this._dirty) return;\n    let cell;\n\n  \tfor (let col=0; col<this._width; col++) {\n  \t\tfor (let row=0; row<this._height; row++) {\n  \t\t\tcell = this._updatedCells[col][row];\n\n  \t\t\tif (cell == null) continue;\n\n  \t\t\tcallback(col, row, cell);\n\n  \t\t\tthis._renderedCells[col][row] = cell;\n  \t\t\tthis._updatedCells[col][row] = null;\n  \t\t}\n  \t}\n  }\n}\n\nexport default DisplayState;\n","import Char from \"./char\";\nimport Font from \"./font\";\nimport Cell from \"./cell\";\nimport DisplayState from \"./display-state\";\n\nconst defaultSettings = {\n  width: 40,\n  height: 30,\n  font: Font(),\n  emptyCell: Cell(),\n  isResponsive: false,\n  forceSquare: true\n}\n\nclass TextGrid {\n  constructor(canvas, settings) {\n    const _settings = Object.assign(defaultSettings, { ...settings });\n    this._width = _settings.width;\n  \tthis._height = _settings.height;\n  \tthis._font = _settings.font;\n  \tthis._responsive = _settings.isResponsive;\n  \tthis._squared = _settings.forceSquare;\n    this._emptyCell = _settings.emptyCell;\n\n    this._glyphCache = new Map();\n\n    this._canvas = canvas;\n    this._context = this._canvas.getContext('2d', { willReadFrequently: true });\n  \tthis._context.font = this._font.toCSS();\n\n    this._ratio = window.devicePixelRatio || 1;\n    this._display = new DisplayState(this._width, this._height);\n\n    this.resetLayout();\n    this.clear();\n  }\n\n  resetLayout() {\n    if (this._responsive) {\n  \t\t// Calculates the dimensions of the containing element first\n  \t\tif (!this._canvas.style.width) this._canvas.style.width = 640;\n  \t\tif (!this._canvas.style.height) this._canvas.style.height = 480;\n\n  \t\tconst elementWidth = parseInt(this._canvas.style.width, 10)  * this._ratio;\n  \t\tconst elementHeight = parseInt(this._canvas.style.height, 10) * this._ratio;\n\n  \t\t// Calculates cell width and height based on the containing element\n  \t\tthis._cellWidth = Math.floor(elementWidth / this._width);\n  \t\tthis._cellHeight = Math.floor(elementHeight / this._height);\n\n  \t\t// Force square aspect ratio\n  \t\tif (this._squared) {\n  \t\t\tthis._cellWidth = this._cellHeight = Math.max(this._cellWidth, this._cellHeight);\n  \t\t}\n\n  \t\tthis._canvas.width = elementWidth;\n  \t\tthis._canvas.height = elementHeight;\n\n  \t} else {\n  \t\t// Measure text width from canvas context\n  \t\tconst textMeasure = this._context.measureText(\"M\");\n\n  \t\t// Canvas measure text with direct multiple of font size\n  \t\tlet textWidth = Math.ceil(textMeasure.width);\n  \t\tlet textHeight = this._font.size;\n\n  \t\t// Force square aspect ratio\n  \t\tif (this._squared) {\n  \t\t\ttextWidth = textHeight = Math.max(textWidth, textHeight);\n  \t\t}\n\n  \t\tthis._cellWidth = Math.ceil(textWidth * this._ratio);\n  \t\tthis._cellHeight = Math.ceil(textHeight * this._ratio);\n\n  \t\tconst drawWidth = textWidth * this._width;\n  \t\tconst drawHeight = textHeight * this._height;\n\n  \t\tthis._canvas.width = drawWidth * this._ratio;\n  \t\tthis._canvas.height = drawHeight * this._ratio;\n\n      this._canvas.style.width = `${drawWidth}px`;\n  \t\tthis._canvas.style.height = `${drawHeight}px`;\n  \t}\n\n  \tthis._font.size = this._font.size * this._ratio;\n  \tthis._context.font = this._font.toCSS();\n  \tthis._context.textAlign = 'center';\n  \tthis._context.textBaseline = 'middle';\n\n    this._cellCache = new Map();\n  }\n\n  get width() {\n    return this._width;\n  }\n\n  get height() {\n    return this._height;\n  }\n\n  clear() {\n    this.fill(this._emptyCell);\n  }\n\n  fill(cell) {\n    for (let col=0; col<this._width; col++) {\n      for (let row=0; row<this._height; row++) {\n        this._display.setCell(col, row, cell);\n      }\n    }\n  }\n\n  readCell(x, y) {\n    return this._display.getCell(x, y);\n  }\n\n  writeCell(x, y, cell) {\n    this._display.setCell(x, y, cell);\n  }\n\n  writeCharacter(x, y, character) {\n    this._display.setCharacter(x, y, character);\n  }\n\n  render() {\n    this._display.render((x, y, cell) => {\n      const cellWidth = this._cellWidth;\n      const cellHeight = this._cellHeight;\n      const blitKey = `${cell.character};${cell.foregroundColor};${cell.backgroundColor}`;\n\n      if (this._cellCache.has(blitKey)) {\n        this._context.putImageData(this._cellCache.get(blitKey), x * cellWidth, y * cellHeight);\n      } else {\n        this._context.fillStyle = cell.backgroundColor;\n        this._context.fillRect(x * cellWidth, y * cellHeight, cellWidth, cellHeight);\n\n        if (cell.character == Char.NULL) return;\n\n        this._context.fillStyle = cell.foregroundColor;\n\n        const xPos = (x * cellWidth) + cellWidth / 2;\n        const yPos = (y * cellHeight) + cellHeight / 2;\n        this._context.fillText(cell.character, Math.round(xPos), Math.round(yPos));\n\n        const blitCell = this._context.getImageData(x * cellWidth, y * cellHeight, cellWidth, cellHeight);\n        this._cellCache.set(blitKey, blitCell);\n      }\n    });\n  }\n\n  pxToCell(ev) {\n  \tconst bounds = this._canvas.getBoundingClientRect();\n  \tconst relativeX = ev.clientX - bounds.left;\n  \tconst relativeY = ev.clientY - bounds.top;\n  \tconst colPos = Math.trunc(relativeX / this._cellWidth * this._ratio);\n  \tconst rowPos = Math.trunc(relativeY / this._cellHeight * this._ratio);\n  \treturn [colPos, rowPos];\n  }\n\n  onClick(handler) {\n    this._canvas.addEventListener('click', (ev) => {\n      const cell = this.pxToCell(ev);\n      handler(cell[0], cell[1]);\n    });\n  }\n\n  onMouseMove(handler) {\n    this._canvas.addEventListener('mousemove', (ev) => {\n      const cell = this.pxToCell(ev);\n      handler(cell[0], cell[1]);\n    });\n  }\n}\n\nexport default TextGrid;\n","import TextGrid from \"overprint/overprint/text-grid\";\r\nimport Font from \"overprint/overprint/font\";\r\nimport Cell from \"overprint/overprint/cell\";\r\nconsole.log(\"Hello World!\");\r\n\r\nconst width = 80;\r\nconst height = 50;\r\n\r\nconst canvas = document.querySelector(\"#game\");\r\nconst grid = new TextGrid(canvas, {\r\n  width: width,\r\n  height: height,\r\n  font: Font(\"Menlo\", false, 15)\r\n});\r\ngrid.render();\r\ngrid.writeCell(40, 25, Cell(\"@\", \"rgba(242, 0, 255, 0.82)\"));\r\n\r\nconst player = {\r\n  x: Math.floor(width / 2),\r\n  y: Math.floor(height / 2)\r\n}\r\ngrid.writeCell(player.x, player.y, Cell(\"@\"));\r\ngrid.render();\r\n\r\nlet action;\r\n\r\ndocument.addEventListener(\"keydown\", (ev) => input(ev.key));\r\n\r\nfunction input(key) {\r\n  switch(key) {\r\n    case \"ArrowUp\": action = { x: 0, y: -1 }; break;\r\n    case \"ArrowDown\": action = { x: 0, y: 1 }; break;\r\n    case \"ArrowLeft\": action = { x: -1, y: 0 }; break;\r\n    case \"ArrowRight\": action = { x: 1, y: 0 }; break;\r\n  }\r\n  console.log (action);\r\n  console.log (player)\r\n}\r\n\r\n\r\nfunction update() {\r\n  if (action) {\r\n    player.x = Math.min(width - 3, Math.max(0, player.x + action.x));\r\n    player.y = Math.min(height - 2, Math.max(0, player.y + action.y));\r\n}\r\n    action = null; \r\n}\r\nfunction render() {\r\n  grid.clear();\r\n  grid.writeCell(player.x, player.y, Cell(\"@\"));\r\n  grid.render();\r\n}\r\n\r\nfunction gameLoop() {\r\n  update();\r\n  render();\r\n  requestAnimationFrame(gameLoop);\r\n}\r\n\r\nrequestAnimationFrame(gameLoop);"],"sourceRoot":""}